<!DOCTYPE html>
<head>
  <script>
    function loadAnalytics() {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.setAttribute("async", "true");
      script.setAttribute("src", "https://www.googletagmanager.com/gtag/js?id=UA-165890546-1");
      document.documentElement.firstChild.appendChild(script);
    }

    if (document.location.host == 'gcode-preview.web.app') {
      loadAnalytics();

      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-165890546-1');
    }
  </script>
  <title>GCode Preview</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body >
  <div id="app">
  <div class="sidebar"  >
    <h1>GCode Preview  <a href="https://www.npmjs.com/package/gcode-preview">
      <img src="https://img.shields.io/npm/v/gcode-preview.svg?style=flat"/>
      </a></h1>
   <div class="scroll-container">
    <div>
      
      <section class="flex flex-column">
        <div class="flex just-between">
          <span>
            Preset
          </span>
          <select id="settings-presets" v-model="selectedPreset">
            <option v-for="(preset, name) in presets" :value="name">{{preset.title}}</option>
          </select>
        </div>
      </section>
      
      <section class="text-center">
        <div class="is-inline-block">
          <img class="is-block" alt="thumbnail generated by slicer" :src="thumbnail" />
          <div class="file-info"><span>{{layerCount + ' layers'}}</span> / <span>{{fileSize}}</span></div>
        </div>
      </section>
      <div class="bulma-tabs bulma-is-small">
        <ul>
          <li :class="{ 'bulma-is-active': activeTab == 'layers' }"><a @click="selectTab('layers')">Layers</a></li>
          <li :class="{ 'bulma-is-active': activeTab == 'travel' }"><a @click="selectTab('travel')">Travel</a></li>
          <li :class="{ 'bulma-is-active': activeTab == 'extrusion' }"><a @click="selectTab('extrusion')">Extrusion</a></li>
          <li :class="{ 'bulma-is-active': activeTab == 'build-volume' }"><a @click="selectTab('build-volume')">Build volume</a></li>
        </ul>
      </div>  
      <div class="panel" v-cloak v-show="activeTab == 'layers'">
      <section>
        <div class="controls">
          <label>Start layer <output id="start-layer-value" >{{startLayer}}</output></label>&nbsp;
          <input
            type="range"
            min="1"
            :max="maxLayer"
            id="start-layer"
            v-model="startLayer"
            :disabled="singleLayerMode"
          />
        </div>
        <div class="controls">
          <label>End layer <output id="end-layer-value" >{{endLayer}}</output></label>&nbsp;
          <input
            type="range"
            min="1"
            :max="maxLayer"
            id="end-layer"
            v-model="endLayer"
          />
        </div>
        <div class="controls">
          <label for="single-layer-mode">Single layer mode</label>
          <input type="checkbox" id="single-layer-mode" v-model="singleLayerMode" />
        </div>
        </section>
      </div>
      <div class="panel" v-cloak v-show="activeTab == 'travel'">
        <section>
          <div class="controls">
            <label for="travel">Render travel</label>
            <input type="checkbox" id="travel"  v-model="renderTravel" />
          </div>
          <div class="controls">
            <label for="travel-color">Travel color</label>
            <input type="color" id="travel-color" value="#0000ff" />
          </div>
        </section>
      </div>
      
      <div class="panel" v-cloak v-show="activeTab == 'extrusion'">
        <section>
          <div class="controls">
            <label for="extrusion">Render extrusion</label
            ><input type="checkbox" v-model="renderExtrusion" />
          </div>
          <div class="controls">
            <label for="render-tubes">Render as tubes</label
            ><input type="checkbox" v-model="renderTubes" />
          </div>
        <div class="controls" v-show="!renderTubes">
          <label>Line width <output>{{lineWidth}}</output></label>&nbsp;
          <input
            type="range"
            min="0.1"
            step="0.1"
            max="10"
            v-model="lineWidth"
            
          />
        </div>
        
        <div class="controls" v-show="renderTubes">
          <label>Extrusion width <output>{{tubeWidth}}</output></label>&nbsp;
          <input
            type="range"
            min="0.05"
            max="3.0"
            step="0.05"
            v-model="tubeWidth"
            
          />
        </div>
      </section>

      <section class="extrusion-colors">
        <div class="flex just-between"># of extrusion colors  <div class="controls">
          <button @click="addColor">+</button>
          <button @click="removeColor">-</button>
        </div></div>

        <div class="controls" v-for="color,index in colors">
          <label for="extrusion-color-t0">Extrusion color (T{{index}})</label>
          <input type="color" v-model="colors[index]" :key="index" />
        </div>
        
      </section>
      <section>
        <div class="controls">
          <label for="highlight">Highlight top layer</label>
          <input type="checkbox" v-model="highlightTopLayer" />
        </div>
        <div class="controls">
          <label for="top-layer-color">Top layer color</label>
          <input type="color" v-model="topLayerColor"  :disabled="!highlightTopLayer" />
        </div>
        <div class="controls">
          <label for="last-segment-color">Highlight last segment</label>
          <input type="checkbox" v-model="highlightLastSegment" />
        </div>
        <div class="controls">
          <label for="last-segment-color">Last segment color</label>
          <input type="color" id="last-segment-color" v-model="lastSegmentColor" :disabled="!highlightLastSegment" />
        </div>
      </section>
      </div>
      <div class="panel" v-cloak v-show="activeTab == 'build-volume'">
      <section>
        <div  class="controls">
          <label for="drawBuildVolume">Render build volume</label>
          <input type="checkbox" v-model="drawBuildVolume" />
        </div>
        <div class="controls">
          <label for="buildVolumeX">Build volume (x)&nbsp;</label>
          <input type="number" v-model="buildVolume.x" step=10 :disabled="!drawBuildVolume" />
        </div>
        <div  class="controls">
          <label for="buildVolumeY">Build volume (y)&nbsp;</label>
          <input type="number" v-model="buildVolume.y" step=10 :disabled="!drawBuildVolume" />
        </div>
        <div  class="controls">
          <label for="buildVolumeZ">Build volume (z)&nbsp;</label>
          <input type="number" v-model="buildVolume.z" step=10 :disabled="!drawBuildVolume" />
        </div>
        <div class="controls">
          <label for="background-color">Background color</label>
          <input type="color" v-model="backgroundColor" />
        </div>
      </section>
      </div>
    </div>

    </div>
    <div>
      <footer>
        <div><a href="http://twitter.com/remcoder">@remcoder</a> ©2020 - 2024</div>

        <div>
          <a href="https://github.com/remcoder/gcode-preview">code</a>
          - <a href="/docs">API docs</a>
          - MIT license
        </div>
      </footer>
    </div>
   </div>
  <div class="wrapper">
    <canvas></canvas>
  </div>
  <div class="dnd">☝️ Drop a gcode file to view it</div>
  
  </div>
  <script type="importmap">
    {
        "imports": {
            "three": "./build/three/build/three.module.js",
            "gcode-preview": "./build/gcode-preview.es.js",
            "lil-gui": "./build/lil-gui/dist/lil-gui.esm.min.js",
            "vue": "./js/vue.esm-browser.js"
        }
    }
  </script>
  <script type="module">
    import {initDemo} from './js/demo.js';
    import {app} from './js/app.js';
  </script>
</body>
